<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Solicitar Donante</title>
  <link rel="stylesheet" href="../static/css/style.css">
</head>
<body>    
  {% include 'partials/navbar.html' %}
<main class="contenedor">
  <h2>Te ayudamos a llegar a mÃ¡s potenciales donantes de sangre.</h2>
  <p class="subtitulo">Crea, comparte y junta los donantes necesarios. ðŸ’™</p>   
<!-- Formulario de Solicitud -->
<form id="agendarForm" class="formulario" method="POST" action="{{ url_for('donaciones_web.crear_solicitud_donantes') }}">
    <h2>Registrar Solicitud de DonaciÃ³n</h2>
    <div class="campo">
      <label for="tipo_sangre">Tipo de sangre</label>
      <select id="tipo_sangre" name="tipo_sangre" required>
        <option value="">Seleccione un tipo</option>
        <option value="O+">O+</option>
        <option value="O-">O-</option>
        <option value="A+">A+</option>
        <option value="A-">A-</option>
        <option value="B+">B+</option>
        <option value="B-">B-</option>
        <option value="AB+">AB+</option>
        <option value="AB-">AB-</option>
      </select>
    </div>

    <div class="campo">
      <label for="cantidad">Cantidad de donantes</label>
      <input type="number" id="cantidad" name="cantidad" min="1" required>
    </div>

    <div class="campo">
      <label for="fecha_solicitud">Fecha de solicitud</label>
      <input type="date" id="fecha_solicitud" name="fecha_solicitud" required>
    </div>

    <div class="campo">
      <label for="comentarios">Comentarios</label>
      <textarea id="comentarios" name="comentarios" placeholder="Agregue detalles adicionales..."></textarea>
    </div>

    <div class="campo">
      <label for="motivo">Motivo</label>
      <textarea id="motivo" name="motivo" required placeholder="Describa el motivo de la solicitud..."></textarea>
    </div>

    <button type="submit" class="boton">Enviar solicitud</button>
  </form>

  </main>
{% include 'partials/footer.html' %}
</body>
<script>
document.getElementById("agendarForm").addEventListener("submit", async function(e) {
    e.preventDefault(); // evita que se recargue la pÃ¡gina

    const form = e.target;
    const formData = new FormData(form);

    try {
        const response = await fetch(form.action, {
            method: "POST",
            body: formData
        });

        const data = await response.json();

        if (response.ok) {
            alert("Solicitud enviada correctamente ðŸ’™");
            form.reset(); // limpia el formulario
        } else {
            alert("Error: " + (data.error || "No se pudo procesar la solicitud"));
        }

    } catch (error) {
        alert("Error de red o servidor: " + error.message);
    }
});
</script>

</html>
